(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const U={};function In(e){U.context=e}const Dn=(e,t)=>e===t,H=Symbol("solid-proxy"),Ze=Symbol("solid-track"),$e={equals:Dn};let Ht=Yt;const ne=1,Le=2,Wt={owned:null,cleanups:null,context:null,owner:null};var T=null;let se=null,C=null,N=null,V=null,Be=0;function Xe(e,t){const n=C,r=T,o=e.length===0,i=o?Wt:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},l=o?e:()=>e(()=>ue(()=>Ue(i)));T=i,C=null;try{return _e(l,!0)}finally{C=n,T=r}}function st(e,t){t=t?Object.assign({},$e,t):$e;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.value)),Vt(n,o));return[zt.bind(n),r]}function Ce(e,t,n){const r=lt(e,t,!1,ne);xe(r)}function Rn(e,t,n){Ht=Un;const r=lt(e,t,!1,ne);r.user=!0,V?V.push(r):xe(r)}function me(e,t,n){n=n?Object.assign({},$e,n):$e;const r=lt(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,xe(r),zt.bind(r)}function Qt(e){return _e(e,!1)}function ue(e){if(C===null)return e();const t=C;C=null;try{return e()}finally{C=t}}function qn(e,t,n){const r=Array.isArray(e);let o,i=n&&n.defer;return l=>{let s;if(r){s=Array(e.length);for(let a=0;a<e.length;a++)s[a]=e[a]()}else s=e();if(i){i=!1;return}const c=ue(()=>t(s,o,l));return o=s,c}}function Kn(e){return T===null||(T.cleanups===null?T.cleanups=[e]:T.cleanups.push(e)),e}function Gt(){return C}function Fn(e){const t=me(e),n=me(()=>Je(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function zt(){const e=se;if(this.sources&&(this.state||e))if(this.state===ne||e)xe(this);else{const t=N;N=null,_e(()=>De(this),!1),N=t}if(C){const t=this.observers?this.observers.length:0;C.sources?(C.sources.push(this),C.sourceSlots.push(t)):(C.sources=[this],C.sourceSlots=[t]),this.observers?(this.observers.push(C),this.observerSlots.push(C.sources.length-1)):(this.observers=[C],this.observerSlots=[C.sources.length-1])}return this.value}function Vt(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&_e(()=>{for(let o=0;o<e.observers.length;o+=1){const i=e.observers[o],l=se&&se.running;l&&se.disposed.has(i),(l&&!i.tState||!l&&!i.state)&&(i.pure?N.push(i):V.push(i),i.observers&&Zt(i)),l||(i.state=ne)}if(N.length>1e6)throw N=[],new Error},!1)),t}function xe(e){if(!e.fn)return;Ue(e);const t=T,n=C,r=Be;C=T=e,jn(e,e.value,r),C=n,T=t}function jn(e,t,n){let r;try{r=e.fn(t)}catch(o){return e.pure&&(e.state=ne,e.owned&&e.owned.forEach(Ue),e.owned=null),e.updatedAt=n+1,Xt(o)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Vt(e,r):e.value=r,e.updatedAt=n)}function lt(e,t,n,r=ne,o){const i={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:T,context:null,pure:n};return T===null||T!==Wt&&(T.owned?T.owned.push(i):T.owned=[i]),i}function Ie(e){const t=se;if(e.state===0||t)return;if(e.state===Le||t)return De(e);if(e.suspense&&ue(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Be);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===ne||t)xe(e);else if(e.state===Le||t){const o=N;N=null,_e(()=>De(e,n[0]),!1),N=o}}function _e(e,t){if(N)return e();let n=!1;t||(N=[]),V?n=!0:V=[],Be++;try{const r=e();return Bn(n),r}catch(r){n||(V=null),N=null,Xt(r)}}function Bn(e){if(N&&(Yt(N),N=null),e)return;const t=V;V=null,t.length&&_e(()=>Ht(t),!1)}function Yt(e){for(let t=0;t<e.length;t++)Ie(e[t])}function Un(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:Ie(r)}for(U.context&&In(),t=0;t<n;t++)Ie(e[t])}function De(e,t){const n=se;e.state=0;for(let r=0;r<e.sources.length;r+=1){const o=e.sources[r];o.sources&&(o.state===ne||n?o!==t&&(!o.updatedAt||o.updatedAt<Be)&&Ie(o):(o.state===Le||n)&&De(o,t))}}function Zt(e){const t=se;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=Le,r.pure?N.push(r):V.push(r),r.observers&&Zt(r))}}function Ue(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const i=o.pop(),l=n.observerSlots.pop();r<o.length&&(i.sourceSlots[l]=r,o[r]=i,n.observerSlots[r]=l)}}if(e.owned){for(t=0;t<e.owned.length;t++)Ue(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Hn(e){return e instanceof Error||typeof e=="string"?e:new Error("Unknown error")}function Xt(e){throw e=Hn(e),e}function Je(e){if(typeof e=="function"&&!e.length)return Je(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=Je(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}const kt=Symbol("fallback");function St(e){for(let t=0;t<e.length;t++)e[t]()}function Wn(e,t,n={}){let r=[],o=[],i=[],l=[],s=0,c;return Kn(()=>St(i)),()=>{const a=e()||[];return a[Ze],ue(()=>{if(a.length===0)return s!==0&&(St(i),i=[],r=[],o=[],s=0,l=[]),n.fallback&&(r=[kt],o[0]=Xe(d=>(i[0]=d,n.fallback())),s=1),o;for(r[0]===kt&&(i[0](),i=[],r=[],o=[],s=0),c=0;c<a.length;c++)c<r.length&&r[c]!==a[c]?l[c](()=>a[c]):c>=r.length&&(o[c]=Xe(h));for(;c<r.length;c++)i[c]();return s=l.length=i.length=a.length,r=a.slice(0),o=o.slice(0,s)});function h(d){i[c]=d;const[f,g]=st(a[c]);return l[c]=g,t(f,c)}}}function ee(e,t){return ue(()=>e(t||{}))}function Te(){return!0}const Qn={get(e,t,n){return t===H?n:e.get(t)},has(e,t){return t===H?!0:e.has(t)},set:Te,deleteProperty:Te,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Te,deleteProperty:Te}},ownKeys(e){return e.keys()}};function We(e){return(e=typeof e=="function"?e():e)?e:{}}function Gn(...e){let t=!1;for(let r=0;r<e.length;r++){const o=e[r];t=t||!!o&&H in o,e[r]=typeof o=="function"?(t=!0,me(o)):o}if(t)return new Proxy({get(r){for(let o=e.length-1;o>=0;o--){const i=We(e[o])[r];if(i!==void 0)return i}},has(r){for(let o=e.length-1;o>=0;o--)if(r in We(e[o]))return!0;return!1},keys(){const r=[];for(let o=0;o<e.length;o++)r.push(...Object.keys(We(e[o])));return[...new Set(r)]}},Qn);const n={};for(let r=e.length-1;r>=0;r--)if(e[r]){const o=Object.getOwnPropertyDescriptors(e[r]);for(const i in o)i in n||Object.defineProperty(n,i,{enumerable:!0,get(){for(let l=e.length-1;l>=0;l--){const s=(e[l]||{})[i];if(s!==void 0)return s}}})}return n}function zn(e){const t="fallback"in e&&{fallback:()=>e.fallback};return me(Wn(()=>e.each,e.children,t||void 0))}function Vn(e){let t=!1,n=!1;const r=(l,s)=>l[0]===s[0]&&(t?l[1]===s[1]:!l[1]==!s[1])&&l[2]===s[2],o=Fn(()=>e.children),i=me(()=>{let l=o();Array.isArray(l)||(l=[l]);for(let s=0;s<l.length;s++){const c=l[s].when;if(c)return n=!!l[s].keyed,[s,c,l[s]]}return[-1]},void 0,{equals:r});return me(()=>{const[l,s,c]=i();if(l<0)return e.fallback;const a=c.children,h=typeof a=="function"&&a.length>0;return t=n||h,h?ue(()=>a(s)):a},void 0,void 0)}function Ct(e){return e}function Yn(e,t,n){let r=n.length,o=t.length,i=r,l=0,s=0,c=t[o-1].nextSibling,a=null;for(;l<o||s<i;){if(t[l]===n[s]){l++,s++;continue}for(;t[o-1]===n[i-1];)o--,i--;if(o===l){const h=i<r?s?n[s-1].nextSibling:n[i-s]:c;for(;s<i;)e.insertBefore(n[s++],h)}else if(i===s)for(;l<o;)(!a||!a.has(t[l]))&&t[l].remove(),l++;else if(t[l]===n[i-1]&&n[s]===t[o-1]){const h=t[--o].nextSibling;e.insertBefore(n[s++],t[l++].nextSibling),e.insertBefore(n[--i],h),t[o]=n[i]}else{if(!a){a=new Map;let d=s;for(;d<i;)a.set(n[d],d++)}const h=a.get(t[l]);if(h!=null)if(s<h&&h<i){let d=l,f=1,g;for(;++d<o&&d<i&&!((g=a.get(t[d]))==null||g!==h+f);)f++;if(f>h-s){const u=t[l];for(;s<h;)e.insertBefore(n[s++],u)}else e.replaceChild(n[s++],t[l++])}else l++;else t[l++].remove()}}}const Pt="_$DX_DELEGATE";function Zn(e,t,n,r={}){let o;return Xe(i=>{o=i,t===document?e():le(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{o(),t.textContent=""}}function ct(e,t,n){const r=document.createElement("template");if(r.innerHTML=e,t&&r.innerHTML.split("<").length-1!==t)throw`The browser resolved template HTML does not match JSX input:
${r.innerHTML}

${e}. Is your HTML properly formed?`;let o=r.content.firstChild;return n&&(o=o.firstChild),o}function Xn(e,t=window.document){const n=t[Pt]||(t[Pt]=new Set);for(let r=0,o=e.length;r<o;r++){const i=e[r];n.has(i)||(n.add(i),t.addEventListener(i,er))}}function At(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const o=n[0];e.addEventListener(t,n[0]=i=>o.call(e,n[1],i))}else e.addEventListener(t,n)}function Jn(e,t,n){return ue(()=>e(t,n))}function le(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return Re(e,t,r,n);Ce(o=>Re(e,t(),o,n),r)}function er(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}}),U.registry&&!U.done&&(U.done=_$HY.done=!0);n;){const r=n[t];if(r&&!n.disabled){const o=n[`${t}Data`];if(o!==void 0?r.call(n,o,e):r.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function Re(e,t,n,r,o){if(U.context){!n&&(n=[...e.childNodes]);let s=[];for(let c=0;c<n.length;c++){const a=n[c];a.nodeType===8&&a.data==="!"?a.remove():s.push(a)}n=s}for(;typeof n=="function";)n=n();if(t===n)return n;const i=typeof t,l=r!==void 0;if(e=l&&n[0]&&n[0].parentNode||e,i==="string"||i==="number"){if(U.context)return n;if(i==="number"&&(t=t.toString()),l){let s=n[0];s&&s.nodeType===3?s.data=t:s=document.createTextNode(t),n=ge(e,n,r,s)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||i==="boolean"){if(U.context)return n;n=ge(e,n,r)}else{if(i==="function")return Ce(()=>{let s=t();for(;typeof s=="function";)s=s();n=Re(e,s,n,r)}),()=>n;if(Array.isArray(t)){const s=[],c=n&&Array.isArray(n);if(et(s,t,n,o))return Ce(()=>n=Re(e,s,n,r,!0)),()=>n;if(U.context){if(!s.length)return n;for(let a=0;a<s.length;a++)if(s[a].parentNode)return n=s}if(s.length===0){if(n=ge(e,n,r),l)return n}else c?n.length===0?Et(e,s,r):Yn(e,n,s):(n&&ge(e),Et(e,s));n=s}else if(t instanceof Node){if(U.context&&t.parentNode)return n=l?[t]:t;if(Array.isArray(n)){if(l)return n=ge(e,n,r,t);ge(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}else console.warn("Unrecognized value. Skipped inserting",t)}return n}function et(e,t,n,r){let o=!1;for(let i=0,l=t.length;i<l;i++){let s=t[i],c=n&&n[i];if(s instanceof Node)e.push(s);else if(!(s==null||s===!0||s===!1))if(Array.isArray(s))o=et(e,s,c)||o;else if(typeof s=="function")if(r){for(;typeof s=="function";)s=s();o=et(e,Array.isArray(s)?s:[s],Array.isArray(c)?c:[c])||o}else e.push(s),o=!0;else{const a=String(s);c&&c.nodeType===3?(c.data=a,e.push(c)):e.push(document.createTextNode(a))}}return o}function Et(e,t,n=null){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function ge(e,t,n,r){if(n===void 0)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let i=!1;for(let l=t.length-1;l>=0;l--){const s=t[l];if(o!==s){const c=s.parentNode===e;!i&&!l?c?e.replaceChild(o,s):e.insertBefore(o,n):c&&s.remove()}else i=!0}}else e.insertBefore(o,n);return[o]}const qe=Symbol("store-raw"),Pe=Symbol("store-node"),tr=Symbol("store-name");function Jt(e,t){let n=e[H];if(!n&&(Object.defineProperty(e,H,{value:n=new Proxy(e,or)}),!Array.isArray(e))){const r=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let i=0,l=r.length;i<l;i++){const s=r[i];o[s].get&&Object.defineProperty(e,s,{enumerable:o[s].enumerable,get:o[s].get.bind(n)})}}return n}function be(e){let t;return e!=null&&typeof e=="object"&&(e[H]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function ve(e,t=new Set){let n,r,o,i;if(n=e!=null&&e[qe])return n;if(!be(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let l=0,s=e.length;l<s;l++)o=e[l],(r=ve(o,t))!==o&&(e[l]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const l=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let c=0,a=l.length;c<a;c++)i=l[c],!s[i].get&&(o=e[i],(r=ve(o,t))!==o&&(e[i]=r))}return e}function at(e){let t=e[Pe];return t||Object.defineProperty(e,Pe,{value:t={}}),t}function tt(e,t,n){return e[t]||(e[t]=tn(n))}function nr(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===H||t===Pe||t===tr||(delete n.value,delete n.writable,n.get=()=>e[H][t]),n}function en(e){if(Gt()){const t=at(e);(t._||(t._=tn()))()}}function rr(e){return en(e),Reflect.ownKeys(e)}function tn(e){const[t,n]=st(e,{equals:!1,internal:!0});return t.$=n,t}const or={get(e,t,n){if(t===qe)return e;if(t===H)return n;if(t===Ze)return en(e),n;const r=at(e),o=r.hasOwnProperty(t);let i=o?r[t]():e[t];if(t===Pe||t==="__proto__")return i;if(!o){const l=Object.getOwnPropertyDescriptor(e,t);Gt()&&(typeof i!="function"||e.hasOwnProperty(t))&&!(l&&l.get)&&(i=tt(r,t,i)())}return be(i)?Jt(i):i},has(e,t){return t===qe||t===H||t===Ze||t===Pe||t==="__proto__"?!0:(this.get(e,t,e),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:rr,getOwnPropertyDescriptor:nr};function ye(e,t,n,r=!1){if(!r&&e[t]===n)return;const o=e[t],i=e.length;n===void 0?delete e[t]:e[t]=n;let l=at(e),s;(s=tt(l,t,o))&&s.$(()=>n),Array.isArray(e)&&e.length!==i&&(s=tt(l,"length",i))&&s.$(e.length),(s=l._)&&s.$()}function nn(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];ye(e,o,t[o])}}function ir(e,t){if(typeof t=="function"&&(t=t(e)),t=ve(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const o=t[n];e[n]!==o&&ye(e,n,o)}ye(e,"length",r)}else nn(e,t)}function Se(e,t,n=[]){let r,o=e;if(t.length>1){r=t.shift();const l=typeof r,s=Array.isArray(e);if(Array.isArray(r)){for(let c=0;c<r.length;c++)Se(e,[r[c]].concat(t),n);return}else if(s&&l==="function"){for(let c=0;c<e.length;c++)r(e[c],c)&&Se(e,[c].concat(t),n);return}else if(s&&l==="object"){const{from:c=0,to:a=e.length-1,by:h=1}=r;for(let d=c;d<=a;d+=h)Se(e,[d].concat(t),n);return}else if(t.length>1){Se(e[r],t,[r].concat(n));return}o=e[r],n=[r].concat(n)}let i=t[0];typeof i=="function"&&(i=i(o,n),i===o)||r===void 0&&i==null||(i=ve(i),r===void 0||be(o)&&be(i)&&!Array.isArray(i)?nn(o,i):ye(e,r,i))}function sr(...[e,t]){const n=ve(e||{}),r=Array.isArray(n),o=Jt(n);function i(...l){Qt(()=>{r&&l.length===1?ir(n,l[0]):Se(n,l)})}return[o,i]}const Ke=new WeakMap,rn={get(e,t){if(t===qe)return e;const n=e[t];let r;return be(n)?Ke.get(n)||(Ke.set(n,r=new Proxy(n,rn)),r):n},set(e,t,n){return ye(e,t,ve(n)),!0},deleteProperty(e,t){return ye(e,t,void 0,!0),!0}};function lr(e){return t=>{if(be(t)){let n;(n=Ke.get(t))||Ke.set(t,n=new Proxy(t,rn)),e(n)}return t}}/**
 * @license
 * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const q="w",Q="b",M="p",nt="n",Oe="b",cr="r",ar="q",G="k",Qe="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",j=-1,fr={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},v={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},_={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Ge={b:[16,32,17,15],w:[-16,-32,-17,-15]},xt={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},ur=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],dr=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],hr={p:1,n:2,b:4,r:8,q:16,k:32},pr="pnbrqkPNBRQK",Mt=[nt,Oe,cr,ar],gr=7,mr=6,br=1,vr=0,Y={w:[{square:_.a1,flag:v.QSIDE_CASTLE},{square:_.h1,flag:v.KSIDE_CASTLE}],b:[{square:_.a8,flag:v.QSIDE_CASTLE},{square:_.h8,flag:v.KSIDE_CASTLE}]},yr={b:br,w:mr},_r=["1-0","0-1","1/2-1/2","*"];function ce(e){return e>>4}function Ae(e){return e&15}function on(e){return"0123456789".indexOf(e)!==-1}function L(e){const t=Ae(e),n=ce(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(n,n+1)}function Ne(e){return e===q?Q:q}function wr(e){const t=e.split(/\s+/);if(t.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const n=parseInt(t[5],10);if(isNaN(n)||n<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const r=parseInt(t[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const o=t[0].split("/");if(o.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let l=0;l<o.length;l++){let s=0,c=!1;for(let a=0;a<o[l].length;a++)if(on(o[l][a])){if(c)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};s+=parseInt(o[l][a],10),c=!0}else{if(!/^[prnbqkPRNBQK]$/.test(o[l][a]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};s+=1,c=!1}if(s!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(t[3][1]=="3"&&t[1]=="w"||t[3][1]=="6"&&t[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const i=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:l,regex:s}of i){if(!s.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${l} king`};if((t[0].match(s)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${l} kings`}}return{ok:!0}}function kr(e,t){const n=e.from,r=e.to,o=e.piece;let i=0,l=0,s=0;for(let c=0,a=t.length;c<a;c++){const h=t[c].from,d=t[c].to,f=t[c].piece;o===f&&n!==h&&r===d&&(i++,ce(n)===ce(h)&&l++,Ae(n)===Ae(h)&&s++)}return i>0?l>0&&s>0?L(n):s>0?L(n).charAt(1):L(n).charAt(0):""}function Z(e,t,n,r,o,i=void 0,l=v.NORMAL){const s=ce(r);if(o===M&&(s===gr||s===vr))for(let c=0;c<Mt.length;c++){const a=Mt[c];e.push({color:t,from:n,to:r,piece:o,captured:i,promotion:a,flags:l|v.PROMOTION})}else e.push({color:t,from:n,to:r,piece:o,captured:i,flags:l})}function Tt(e){let t=e.charAt(0);return t>="a"&&t<="h"?e.match(/[a-h]\d.*[a-h]\d/)?void 0:M:(t=t.toLowerCase(),t==="o"?G:t)}function Nt(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Ot{constructor(t=Qe){this._board=new Array(128),this._turn=q,this._header={},this._kings={w:j,b:j},this._epSquare=-1,this._halfMoves=0,this._moveNumber=0,this._history=[],this._comments={},this._castling={w:0,b:0},this.load(t)}clear(t=!1){this._board=new Array(128),this._kings={w:j,b:j},this._turn=q,this._castling={w:0,b:0},this._epSquare=j,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{},this._updateSetup(this.fen())}load(t,n=!1){let r=t.split(/\s+/);if(r.length>=2&&r.length<6){const c=["-","-","0","1"];t=r.concat(c.slice(-(6-r.length))).join(" ")}r=t.split(/\s+/);const{ok:o,error:i}=wr(t);if(!o)throw new Error(i);const l=r[0];let s=0;this.clear(n);for(let c=0;c<l.length;c++){const a=l.charAt(c);if(a==="/")s+=8;else if(on(a))s+=parseInt(a,10);else{const h=a<"a"?q:Q;this.put({type:a.toLowerCase(),color:h},L(s)),s++}}this._turn=r[1],r[2].indexOf("K")>-1&&(this._castling.w|=v.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(this._castling.w|=v.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(this._castling.b|=v.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(this._castling.b|=v.QSIDE_CASTLE),this._epSquare=r[3]==="-"?j:_[r[3]],this._halfMoves=parseInt(r[4],10),this._moveNumber=parseInt(r[5],10),this._updateSetup(this.fen())}fen(){var t,n;let r=0,o="";for(let s=_.a8;s<=_.h1;s++){if(this._board[s]){r>0&&(o+=r,r=0);const{color:c,type:a}=this._board[s];o+=c===q?a.toUpperCase():a.toLowerCase()}else r++;s+1&136&&(r>0&&(o+=r),s!==_.h1&&(o+="/"),r=0,s+=8)}let i="";this._castling[q]&v.KSIDE_CASTLE&&(i+="K"),this._castling[q]&v.QSIDE_CASTLE&&(i+="Q"),this._castling[Q]&v.KSIDE_CASTLE&&(i+="k"),this._castling[Q]&v.QSIDE_CASTLE&&(i+="q"),i=i||"-";let l="-";if(this._epSquare!==j){const s=this._epSquare+(this._turn===q?16:-16),c=[s+1,s-1];for(const a of c){if(a&136)continue;const h=this._turn;if(((t=this._board[a])===null||t===void 0?void 0:t.color)===h&&((n=this._board[a])===null||n===void 0?void 0:n.type)===M){this._makeMove({color:h,from:a,to:this._epSquare,piece:M,captured:M,flags:v.EP_CAPTURE});const d=!this._isKingAttacked(h);if(this._undoMove(),d){l=L(this._epSquare);break}}}}return[o,this._turn,i,l,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(t){this._history.length>0||(t!==Qe?(this._header.SetUp="1",this._header.FEN=t):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(Qe)}get(t){return this._board[_[t]]||!1}put({type:t,color:n},r){if(pr.indexOf(t.toLowerCase())===-1||!(r in _))return!1;const o=_[r];return t==G&&!(this._kings[n]==j||this._kings[n]==o)?!1:(this._board[o]={type:t,color:n},t===G&&(this._kings[n]=o),this._updateSetup(this.fen()),!0)}remove(t){const n=this.get(t);return delete this._board[_[t]],n&&n.type===G&&(this._kings[n.color]=j),this._updateSetup(this.fen()),n}_attacked(t,n){for(let r=_.a8;r<=_.h1;r++){if(r&136){r+=7;continue}if(this._board[r]===void 0||this._board[r].color!==t)continue;const o=this._board[r],i=r-n;if(i===0)continue;const l=i+119;if(ur[l]&hr[o.type]){if(o.type===M){if(i>0){if(o.color===q)return!0}else if(o.color===Q)return!0;continue}if(o.type==="n"||o.type==="k")return!0;const s=dr[l];let c=r+s,a=!1;for(;c!==n;){if(this._board[c]!=null){a=!0;break}c+=s}if(!a)return!0}}return!1}_isKingAttacked(t){return this._attacked(Ne(t),this._kings[t])}isAttacked(t,n){return this._attacked(n,_[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},n=[];let r=0,o=0;for(let i=_.a8;i<=_.h1;i++){if(o=(o+1)%2,i&136){i+=7;continue}const l=this._board[i];l&&(t[l.type]=l.type in t?t[l.type]+1:1,l.type===Oe&&n.push(o),r++)}if(r===2)return!0;if(r===3&&(t[Oe]===1||t[nt]===1))return!0;if(r===t[Oe]+2){let i=0;const l=n.length;for(let s=0;s<l;s++)i+=n[s];if(i===0||i===l)return!0}return!1}isThreefoldRepetition(){const t=[],n={};let r=!1;for(;;){const o=this._undoMove();if(!o)break;t.push(o)}for(;;){const o=this.fen().split(" ").slice(0,4).join(" ");n[o]=o in n?n[o]+1:1,n[o]>=3&&(r=!0);const i=t.pop();if(i)this._makeMove(i);else break}return r}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:t=!1,square:n=void 0,piece:r=void 0}={}){const o=this._moves({square:n,piece:r});return t?o.map(i=>this._makePretty(i)):o.map(i=>this._moveToSan(i,o))}_moves({legal:t=!0,piece:n=void 0,square:r=void 0}={}){var o;const i=r?r.toLowerCase():void 0,l=n?.toLowerCase(),s=[],c=this._turn,a=Ne(c);let h=_.a8,d=_.h1,f=!1;if(i)if(i in _)h=d=_[i],f=!0;else return[];for(let u=h;u<=d;u++){if(u&136){u+=7;continue}if(!this._board[u]||this._board[u].color===a)continue;const{type:p}=this._board[u];let b;if(p===M){if(l&&l!==p)continue;b=u+Ge[c][0],this._board[b]||(Z(s,c,u,b,M),b=u+Ge[c][1],yr[c]===ce(u)&&!this._board[b]&&Z(s,c,u,b,M,void 0,v.BIG_PAWN));for(let y=2;y<4;y++)b=u+Ge[c][y],!(b&136)&&(((o=this._board[b])===null||o===void 0?void 0:o.color)===a?Z(s,c,u,b,M,this._board[b].type,v.CAPTURE):b===this._epSquare&&Z(s,c,u,b,M,M,v.EP_CAPTURE))}else{if(l&&l!==p)continue;for(let y=0,w=xt[p].length;y<w;y++){const m=xt[p][y];for(b=u;b+=m,!(b&136);){if(!this._board[b])Z(s,c,u,b,p);else{if(this._board[b].color===c)break;Z(s,c,u,b,p,this._board[b].type,v.CAPTURE);break}if(p===nt||p===G)break}}}}if((l===void 0||l===G)&&(!f||d===this._kings[c])){if(this._castling[c]&v.KSIDE_CASTLE){const u=this._kings[c],p=u+2;!this._board[u+1]&&!this._board[p]&&!this._attacked(a,this._kings[c])&&!this._attacked(a,u+1)&&!this._attacked(a,p)&&Z(s,c,this._kings[c],p,G,void 0,v.KSIDE_CASTLE)}if(this._castling[c]&v.QSIDE_CASTLE){const u=this._kings[c],p=u-2;!this._board[u-1]&&!this._board[u-2]&&!this._board[u-3]&&!this._attacked(a,this._kings[c])&&!this._attacked(a,u-1)&&!this._attacked(a,p)&&Z(s,c,this._kings[c],p,G,void 0,v.QSIDE_CASTLE)}}if(!t)return s;const g=[];for(let u=0,p=s.length;u<p;u++)this._makeMove(s[u]),this._isKingAttacked(c)||g.push(s[u]),this._undoMove();return g}move(t,{strict:n=!1}={}){let r=null;if(typeof t=="string")r=this._moveFromSan(t,n);else if(typeof t=="object"){const i=this._moves();for(let l=0,s=i.length;l<s;l++)if(t.from===L(i[l].from)&&t.to===L(i[l].to)&&(!("promotion"in i[l])||t.promotion===i[l].promotion)){r=i[l];break}}if(!r)throw typeof t=="string"?new Error(`Invalid move: ${t}`):new Error(`Invalid move: ${JSON.stringify(t)}`);const o=this._makePretty(r);return this._makeMove(r),o}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(t){const n=this._turn,r=Ne(n);if(this._push(t),this._board[t.to]=this._board[t.from],delete this._board[t.from],t.flags&v.EP_CAPTURE&&(this._turn===Q?delete this._board[t.to-16]:delete this._board[t.to+16]),t.promotion&&(this._board[t.to]={type:t.promotion,color:n}),this._board[t.to].type===G){if(this._kings[n]=t.to,t.flags&v.KSIDE_CASTLE){const o=t.to-1,i=t.to+1;this._board[o]=this._board[i],delete this._board[i]}else if(t.flags&v.QSIDE_CASTLE){const o=t.to+1,i=t.to-2;this._board[o]=this._board[i],delete this._board[i]}this._castling[n]=0}if(this._castling[n]){for(let o=0,i=Y[n].length;o<i;o++)if(t.from===Y[n][o].square&&this._castling[n]&Y[n][o].flag){this._castling[n]^=Y[n][o].flag;break}}if(this._castling[r]){for(let o=0,i=Y[r].length;o<i;o++)if(t.to===Y[r][o].square&&this._castling[r]&Y[r][o].flag){this._castling[r]^=Y[r][o].flag;break}}t.flags&v.BIG_PAWN?n===Q?this._epSquare=t.to-16:this._epSquare=t.to+16:this._epSquare=j,t.piece===M?this._halfMoves=0:t.flags&(v.CAPTURE|v.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,n===Q&&this._moveNumber++,this._turn=r}undo(){const t=this._undoMove();return t?this._makePretty(t):null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;const n=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber;const r=this._turn,o=Ne(r);if(this._board[n.from]=this._board[n.to],this._board[n.from].type=n.piece,delete this._board[n.to],n.captured)if(n.flags&v.EP_CAPTURE){let i;r===Q?i=n.to-16:i=n.to+16,this._board[i]={type:M,color:o}}else this._board[n.to]={type:n.captured,color:o};if(n.flags&(v.KSIDE_CASTLE|v.QSIDE_CASTLE)){let i,l;n.flags&v.KSIDE_CASTLE?(i=n.to+1,l=n.to-1):(i=n.to-2,l=n.to+1),this._board[i]=this._board[l],delete this._board[l]}return n}pgn({newline:t=`
`,maxWidth:n=0}={}){const r=[];let o=!1;for(const f in this._header)r.push("["+f+' "'+this._header[f]+'"]'+t),o=!0;o&&this._history.length&&r.push(t);const i=f=>{const g=this._comments[this.fen()];if(typeof g<"u"){const u=f.length>0?" ":"";f=`${f}${u}{${g}}`}return f},l=[];for(;this._history.length>0;)l.push(this._undoMove());const s=[];let c="";for(l.length===0&&s.push(i(""));l.length>0;){c=i(c);const f=l.pop();if(!f)break;if(!this._history.length&&f.color==="b"){const g=`${this._moveNumber}. ...`;c=c?`${c} ${g}`:g}else f.color==="w"&&(c.length&&s.push(c),c=this._moveNumber+".");c=c+" "+this._moveToSan(f,this._moves({legal:!0})),this._makeMove(f)}if(c.length&&s.push(i(c)),typeof this._header.Result<"u"&&s.push(this._header.Result),n===0)return r.join("")+s.join(" ");const a=function(){return r.length>0&&r[r.length-1]===" "?(r.pop(),!0):!1},h=function(f,g){for(const u of g.split(" "))if(u){if(f+u.length>n){for(;a();)f--;r.push(t),f=0}r.push(u),f+=u.length,r.push(" "),f++}return a()&&f--,f};let d=0;for(let f=0;f<s.length;f++){if(d+s[f].length>n&&s[f].includes("{")){d=h(d,s[f]);continue}d+s[f].length>n&&f!==0?(r[r.length-1]===" "&&r.pop(),r.push(t),d=0):f!==0&&(r.push(" "),d++),r.push(s[f]),d+=s[f].length}return r.join("")}header(...t){for(let n=0;n<t.length;n+=2)typeof t[n]=="string"&&typeof t[n+1]=="string"&&(this._header[t[n]]=t[n+1]);return this._header}loadPgn(t,{strict:n=!1,newlineChar:r=`\r?
`}={}){function o(m){return m.replace(/\\/g,"\\")}function i(m){const A={},S=m.split(new RegExp(o(r)));let W="",F="";for(let k=0;k<S.length;k++){const R=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;W=S[k].replace(R,"$1"),F=S[k].replace(R,"$2"),W.trim().length>0&&(A[W]=F)}return A}t=t.trim();const s=new RegExp("^(\\[((?:"+o(r)+")|.)*\\])((?:\\s*"+o(r)+"){2}|(?:\\s*"+o(r)+")*$)").exec(t),c=s&&s.length>=2?s[1]:"";this.reset();const a=i(c);let h="";for(const m in a)m.toLowerCase()==="fen"&&(h=a[m]),this.header(m,a[m]);if(!n)h&&this.load(h,!0);else if(a.SetUp==="1"){if(!("FEN"in a))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(a.FEN,!0)}function d(m){return Array.from(m).map(function(A){return A.charCodeAt(0)<128?A.charCodeAt(0).toString(16):encodeURIComponent(A).replace(/%/g,"").toLowerCase()}).join("")}function f(m){return m.length==0?"":decodeURIComponent("%"+(m.match(/.{1,2}/g)||[]).join("%"))}const g=function(m){return m=m.replace(new RegExp(o(r),"g")," "),`{${d(m.slice(1,m.length-1))}}`},u=function(m){if(m.startsWith("{")&&m.endsWith("}"))return f(m.slice(1,m.length-1))};let p=t.replace(c,"").replace(new RegExp(`({[^}]*})+?|;([^${o(r)}]*)`,"g"),function(m,A,S){return A!==void 0?g(A):" "+g(`{${S.slice(1)}}`)}).replace(new RegExp(o(r),"g")," ");const b=/(\([^()]+\))+?/g;for(;b.test(p);)p=p.replace(b,"");p=p.replace(/\d+\.(\.\.)?/g,""),p=p.replace(/\.\.\./g,""),p=p.replace(/\$\d+/g,"");let y=p.trim().split(new RegExp(/\s+/));y=y.filter(m=>m!=="");let w="";for(let m=0;m<y.length;m++){const A=u(y[m]);if(A!==void 0){this._comments[this.fen()]=A;continue}const S=this._moveFromSan(y[m],n);if(S==null)if(_r.indexOf(y[m])>-1)w=y[m];else throw new Error(`Invalid move in PGN: ${y[m]}`);else w="",this._makeMove(S)}w&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",w)}_moveToSan(t,n){let r="";if(t.flags&v.KSIDE_CASTLE)r="O-O";else if(t.flags&v.QSIDE_CASTLE)r="O-O-O";else{if(t.piece!==M){const o=kr(t,n);r+=t.piece.toUpperCase()+o}t.flags&(v.CAPTURE|v.EP_CAPTURE)&&(t.piece===M&&(r+=L(t.from)[0]),r+="x"),r+=L(t.to),t.promotion&&(r+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(t,n=!1){const r=Nt(t);let o=Tt(r),i=this._moves({legal:!0,piece:o});for(let f=0,g=i.length;f<g;f++)if(r===Nt(this._moveToSan(i[f],i)))return i[f];if(n)return null;let l,s,c,a,h,d=!1;s=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),s?(l=s[1],c=s[2],a=s[3],h=s[4],c.length==1&&(d=!0)):(s=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),s&&(l=s[1],c=s[2],a=s[3],h=s[4],c.length==1&&(d=!0))),o=Tt(r),i=this._moves({legal:!0,piece:l||o});for(let f=0,g=i.length;f<g;f++)if(c&&a){if((!l||l.toLowerCase()==i[f].piece)&&_[c]==i[f].from&&_[a]==i[f].to&&(!h||h.toLowerCase()==i[f].promotion))return i[f];if(d){const u=L(i[f].from);if((!l||l.toLowerCase()==i[f].piece)&&_[a]==i[f].to&&(c==u[0]||c==u[1])&&(!h||h.toLowerCase()==i[f].promotion))return i[f]}}return null}ascii(){let t=`   +------------------------+
`;for(let n=_.a8;n<=_.h1;n++){if(Ae(n)===0&&(t+=" "+"87654321"[ce(n)]+" |"),this._board[n]){const r=this._board[n].type,i=this._board[n].color===q?r.toUpperCase():r.toLowerCase();t+=" "+i+" "}else t+=" . ";n+1&136&&(t+=`|
`,n+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const n=this._moves({legal:!1});let r=0;const o=this._turn;for(let i=0,l=n.length;i<l;i++)this._makeMove(n[i]),this._isKingAttacked(o)||(t-1>0?r+=this.perft(t-1):r++),this._undoMove();return r}_makePretty(t){const{color:n,piece:r,from:o,to:i,flags:l,captured:s,promotion:c}=t;let a="";for(const g in v)v[g]&l&&(a+=fr[g]);const h=L(o),d=L(i),f={color:n,piece:r,from:h,to:d,san:this._moveToSan(t,this._moves({legal:!0})),flags:a,lan:h+d,before:this.fen(),after:""};return this._makeMove(t),f.after=this.fen(),this._undoMove(),s&&(f.captured=s),c&&(f.promotion=c,f.lan+=c),f}turn(){return this._turn}board(){const t=[];let n=[];for(let r=_.a8;r<=_.h1;r++)this._board[r]==null?n.push(null):n.push({square:L(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(t.push(n),n=[],r+=8);return t}squareColor(t){if(t in _){const n=_[t];return(ce(n)+Ae(n))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const n=[],r=[];for(;this._history.length>0;)n.push(this._undoMove());for(;;){const o=n.pop();if(!o)break;t?r.push(this._makePretty(o)):r.push(this._moveToSan(o,this._moves())),this._makeMove(o)}return r}_pruneComments(){const t=[],n={},r=o=>{o in this._comments&&(n[o]=this._comments[o])};for(;this._history.length>0;)t.push(this._undoMove());for(r(this.fen());;){const o=t.pop();if(!o)break;this._makeMove(o),r(this.fen())}this._comments=n}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const n=this._comments[t];return delete this._comments[t],{fen:t,comment:n}})}}const Sr=["white","black"],ft=["a","b","c","d","e","f","g","h"],ut=["1","2","3","4","5","6","7","8"],Cr=[...ut].reverse(),dt=Array.prototype.concat(...ft.map(e=>ut.map(t=>e+t))),I=e=>dt[8*e[0]+e[1]],P=e=>[e.charCodeAt(0)-97,e.charCodeAt(1)-49],sn=dt.map(P);function Pr(e){let t;const n=()=>(t===void 0&&(t=e()),t);return n.clear=()=>{t=void 0},n}const Ar=()=>{let e;return{start(){e=performance.now()},cancel(){e=void 0},stop(){if(!e)return 0;const t=performance.now()-e;return e=void 0,t}}},ht=e=>e==="white"?"black":"white",Ee=(e,t)=>{const n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},rt=(e,t)=>e.role===t.role&&e.color===t.color,Me=e=>(t,n)=>[(n?t[0]:7-t[0])*e.width/8,(n?7-t[1]:t[1])*e.height/8],B=(e,t)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px)`},ln=(e,t,n=1)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px) scale(${n})`},pt=(e,t)=>{e.style.visibility=t?"visible":"hidden"},de=e=>{var t;if(e.clientX||e.clientX===0)return[e.clientX,e.clientY];if(!((t=e.targetTouches)===null||t===void 0)&&t[0])return[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},cn=e=>e.buttons===2||e.button===2,z=(e,t)=>{const n=document.createElement(e);return t&&(n.className=t),n};function an(e,t,n){const r=P(e);return t||(r[0]=7-r[0],r[1]=7-r[1]),[n.left+n.width*r[0]/8+n.width/16,n.top+n.height*(7-r[1])/8+n.height/16]}const fe=(e,t)=>Math.abs(e-t),Er=e=>(t,n,r,o)=>fe(t,r)<2&&(e==="white"?o===n+1||n<=1&&o===n+2&&t===r:o===n-1||n>=6&&o===n-2&&t===r),fn=(e,t,n,r)=>{const o=fe(e,n),i=fe(t,r);return o===1&&i===2||o===2&&i===1},un=(e,t,n,r)=>fe(e,n)===fe(t,r),dn=(e,t,n,r)=>e===n||t===r,hn=(e,t,n,r)=>un(e,t,n,r)||dn(e,t,n,r),xr=(e,t,n)=>(r,o,i,l)=>fe(r,i)<2&&fe(o,l)<2||n&&o===l&&o===(e==="white"?0:7)&&(r===4&&(i===2&&t.includes(0)||i===6&&t.includes(7))||t.includes(i));function Mr(e,t){const n=t==="white"?"1":"8",r=[];for(const[o,i]of e)o[1]===n&&i.color===t&&i.role==="rook"&&r.push(P(o)[0]);return r}function pn(e,t,n){const r=e.get(t);if(!r)return[];const o=P(t),i=r.role,l=i==="pawn"?Er(r.color):i==="knight"?fn:i==="bishop"?un:i==="rook"?dn:i==="queen"?hn:xr(r.color,Mr(e,r.color),n);return sn.filter(s=>(o[0]!==s[0]||o[1]!==s[1])&&l(o[0],o[1],s[0],s[1])).map(I)}function O(e,...t){e&&setTimeout(()=>e(...t),1)}function Tr(e){e.orientation=ht(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0}function Nr(e,t){for(const[n,r]of t)r?e.pieces.set(n,r):e.pieces.delete(n)}function Or(e,t){if(e.check=void 0,t===!0&&(t=e.turnColor),t)for(const[n,r]of e.pieces)r.role==="king"&&r.color===t&&(e.check=n)}function $r(e,t,n,r){oe(e),e.premovable.current=[t,n],O(e.premovable.events.set,t,n,r)}function re(e){e.premovable.current&&(e.premovable.current=void 0,O(e.premovable.events.unset))}function Lr(e,t,n){re(e),e.predroppable.current={role:t,key:n},O(e.predroppable.events.set,t,n)}function oe(e){const t=e.predroppable;t.current&&(t.current=void 0,O(t.events.unset))}function Ir(e,t,n){if(!e.autoCastle)return!1;const r=e.pieces.get(t);if(!r||r.role!=="king")return!1;const o=P(t),i=P(n);if(o[1]!==0&&o[1]!==7||o[1]!==i[1])return!1;o[0]===4&&!e.pieces.has(n)&&(i[0]===6?n=I([7,i[1]]):i[0]===2&&(n=I([0,i[1]])));const l=e.pieces.get(n);return!l||l.color!==r.color||l.role!=="rook"?!1:(e.pieces.delete(t),e.pieces.delete(n),o[0]<i[0]?(e.pieces.set(I([6,i[1]]),r),e.pieces.set(I([5,i[1]]),l)):(e.pieces.set(I([2,i[1]]),r),e.pieces.set(I([3,i[1]]),l)),!0)}function gn(e,t,n){const r=e.pieces.get(t),o=e.pieces.get(n);if(t===n||!r)return!1;const i=o&&o.color!==r.color?o:void 0;return n===e.selected&&D(e),O(e.events.move,t,n,i),Ir(e,t,n)||(e.pieces.set(n,r),e.pieces.delete(t)),e.lastMove=[t,n],e.check=void 0,O(e.events.change),i||!0}function gt(e,t,n,r){if(e.pieces.has(n))if(r)e.pieces.delete(n);else return!1;return O(e.events.dropNewPiece,t,n),e.pieces.set(n,t),e.lastMove=[n],e.check=void 0,O(e.events.change),e.movable.dests=void 0,e.turnColor=ht(e.turnColor),!0}function mn(e,t,n){const r=gn(e,t,n);return r&&(e.movable.dests=void 0,e.turnColor=ht(e.turnColor),e.animation.current=void 0),r}function bn(e,t,n){if(mt(e,t,n)){const r=mn(e,t,n);if(r){const o=e.hold.stop();D(e);const i={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:o};return r!==!0&&(i.captured=r),O(e.movable.events.after,t,n,i),!0}}else if(Rr(e,t,n))return $r(e,t,n,{ctrlKey:e.stats.ctrlKey}),D(e),!0;return D(e),!1}function vn(e,t,n,r){const o=e.pieces.get(t);o&&(Dr(e,t,n)||r)?(e.pieces.delete(t),gt(e,o,n,r),O(e.movable.events.afterNewPiece,o.role,n,{premove:!1,predrop:!1})):o&&qr(e,t,n)?Lr(e,o.role,n):(re(e),oe(e)),e.pieces.delete(t),D(e)}function ot(e,t,n){if(O(e.events.select,t),e.selected){if(e.selected===t&&!e.draggable.enabled){D(e),e.hold.cancel();return}else if((e.selectable.enabled||n)&&e.selected!==t&&bn(e,e.selected,t)){e.stats.dragged=!1;return}}(e.selectable.enabled||e.draggable.enabled)&&(_n(e,t)||bt(e,t))&&(yn(e,t),e.hold.start())}function yn(e,t){e.selected=t,bt(e,t)?e.premovable.dests=pn(e.pieces,t,e.premovable.castle):e.premovable.dests=void 0}function D(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function _n(e,t){const n=e.pieces.get(t);return!!n&&(e.movable.color==="both"||e.movable.color===n.color&&e.turnColor===n.color)}const mt=(e,t,n)=>{var r,o;return t!==n&&_n(e,t)&&(e.movable.free||!!(!((o=(r=e.movable.dests)===null||r===void 0?void 0:r.get(t))===null||o===void 0)&&o.includes(n)))};function Dr(e,t,n){const r=e.pieces.get(t);return!!r&&(t===n||!e.pieces.has(n))&&(e.movable.color==="both"||e.movable.color===r.color&&e.turnColor===r.color)}function bt(e,t){const n=e.pieces.get(t);return!!n&&e.premovable.enabled&&e.movable.color===n.color&&e.turnColor!==n.color}const Rr=(e,t,n)=>t!==n&&bt(e,t)&&pn(e.pieces,t,e.premovable.castle).includes(n);function qr(e,t,n){const r=e.pieces.get(t),o=e.pieces.get(n);return!!r&&(!o||o.color!==e.movable.color)&&e.predroppable.enabled&&(r.role!=="pawn"||n[1]!=="1"&&n[1]!=="8")&&e.movable.color===r.color&&e.turnColor!==r.color}function Kr(e,t){const n=e.pieces.get(t);return!!n&&e.draggable.enabled&&(e.movable.color==="both"||e.movable.color===n.color&&(e.turnColor===n.color||e.premovable.enabled))}function Fr(e){const t=e.premovable.current;if(!t)return!1;const n=t[0],r=t[1];let o=!1;if(mt(e,n,r)){const i=mn(e,n,r);if(i){const l={premove:!0};i!==!0&&(l.captured=i),O(e.movable.events.after,n,r,l),o=!0}}return re(e),o}function jr(e,t){const n=e.predroppable.current;let r=!1;if(!n)return!1;if(t(n)){const o={role:n.role,color:e.movable.color};gt(e,o,n.key)&&(O(e.movable.events.afterNewPiece,n.role,n.key,{premove:!1,predrop:!0}),r=!0)}return oe(e),r}function vt(e){re(e),oe(e),D(e)}function $t(e){e.movable.color=e.movable.dests=e.animation.current=void 0,vt(e)}function he(e,t,n){let r=Math.floor(8*(e[0]-n.left)/n.width);t||(r=7-r);let o=7-Math.floor(8*(e[1]-n.top)/n.height);return t||(o=7-o),r>=0&&r<8&&o>=0&&o<8?I([r,o]):void 0}function Br(e,t,n,r){const o=P(e),i=sn.filter(a=>hn(o[0],o[1],a[0],a[1])||fn(o[0],o[1],a[0],a[1])),s=i.map(a=>an(I(a),n,r)).map(a=>Ee(t,a)),[,c]=s.reduce((a,h,d)=>a[0]<h?a:[h,d],[s[0],0]);return I(i[c])}const $=e=>e.orientation==="white",wn="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",Ur={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},Hr={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};function kn(e){e==="start"&&(e=wn);const t=new Map;let n=7,r=0;for(const o of e)switch(o){case" ":case"[":return t;case"/":if(--n,n<0)return t;r=0;break;case"~":{const i=t.get(I([r-1,n]));i&&(i.promoted=!0);break}default:{const i=o.charCodeAt(0);if(i<57)r+=i-48;else{const l=o.toLowerCase();t.set(I([r,n]),{role:Ur[l],color:o===l?"black":"white"}),++r}}}return t}function Wr(e){return Cr.map(t=>ft.map(n=>{const r=e.get(n+t);if(r){let o=Hr[r.role];return r.color==="white"&&(o=o.toUpperCase()),r.promoted&&(o+="~"),o}else return"1"}).join("")).join("/").replace(/1{2,}/g,t=>t.length.toString())}function Sn(e,t){t.animation&&(yt(e.animation,t.animation),(e.animation.duration||0)<70&&(e.animation.enabled=!1))}function Cn(e,t){var n,r,o;if(!((n=t.movable)===null||n===void 0)&&n.dests&&(e.movable.dests=void 0),!((r=t.drawable)===null||r===void 0)&&r.autoShapes&&(e.drawable.autoShapes=[]),yt(e,t),t.fen&&(e.pieces=kn(t.fen),e.drawable.shapes=((o=t.drawable)===null||o===void 0?void 0:o.shapes)||[]),"check"in t&&Or(e,t.check||!1),"lastMove"in t&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&yn(e,e.selected),Sn(e,t),!e.movable.rookCastle&&e.movable.dests){const i=e.movable.color==="white"?"1":"8",l="e"+i,s=e.movable.dests.get(l),c=e.pieces.get(l);if(!s||!c||c.role!=="king")return;e.movable.dests.set(l,s.filter(a=>!(a==="a"+i&&s.includes("c"+i))&&!(a==="h"+i&&s.includes("g"+i))))}}function yt(e,t){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(e,n)&&Lt(e[n])&&Lt(t[n])?yt(e[n],t[n]):e[n]=t[n])}function Lt(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}const ie=(e,t)=>t.animation.enabled?zr(e,t):J(e,t);function J(e,t){const n=e(t);return t.dom.redraw(),n}const ze=(e,t)=>({key:e,pos:P(e),piece:t}),Qr=(e,t)=>t.sort((n,r)=>Ee(e.pos,n.pos)-Ee(e.pos,r.pos))[0];function Gr(e,t){const n=new Map,r=[],o=new Map,i=[],l=[],s=new Map;let c,a,h;for(const[d,f]of e)s.set(d,ze(d,f));for(const d of dt)c=t.pieces.get(d),a=s.get(d),c?a?rt(c,a.piece)||(i.push(a),l.push(ze(d,c))):l.push(ze(d,c)):a&&i.push(a);for(const d of l)a=Qr(d,i.filter(f=>rt(d.piece,f.piece))),a&&(h=[a.pos[0]-d.pos[0],a.pos[1]-d.pos[1]],n.set(d.key,h.concat(h)),r.push(a.key));for(const d of i)r.includes(d.key)||o.set(d.key,d.piece);return{anims:n,fadings:o}}function Pn(e,t){const n=e.animation.current;if(n===void 0){e.dom.destroyed||e.dom.redrawNow();return}const r=1-(t-n.start)*n.frequency;if(r<=0)e.animation.current=void 0,e.dom.redrawNow();else{const o=Vr(r);for(const i of n.plan.anims.values())i[2]=i[0]*o,i[3]=i[1]*o;e.dom.redrawNow(!0),requestAnimationFrame((i=performance.now())=>Pn(e,i))}}function zr(e,t){const n=new Map(t.pieces),r=e(t),o=Gr(n,t);if(o.anims.size||o.fadings.size){const i=t.animation.current&&t.animation.current.start;t.animation.current={start:performance.now(),frequency:1/t.animation.duration,plan:o},i||Pn(t,performance.now())}else t.dom.redraw();return r}const Vr=e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,Yr=["green","red","blue","yellow"];function Zr(e,t){if(t.touches&&t.touches.length>1)return;t.stopPropagation(),t.preventDefault(),t.ctrlKey?D(e):vt(e);const n=de(t),r=he(n,$(e),e.dom.bounds());r&&(e.drawable.current={orig:r,pos:n,brush:to(t),snapToValidMove:e.drawable.defaultSnapToValidMove},An(e))}function An(e){requestAnimationFrame(()=>{const t=e.drawable.current;if(t){const n=he(t.pos,$(e),e.dom.bounds());n||(t.snapToValidMove=!1);const r=t.snapToValidMove?Br(t.orig,t.pos,$(e),e.dom.bounds()):n;r!==t.mouseSq&&(t.mouseSq=r,t.dest=r!==t.orig?r:void 0,e.dom.redrawNow()),An(e)}})}function Xr(e,t){e.drawable.current&&(e.drawable.current.pos=de(t))}function Jr(e){const t=e.drawable.current;t&&(t.mouseSq&&no(e.drawable,t),En(e))}function En(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function eo(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),xn(e.drawable))}function to(e){var t;const n=(e.shiftKey||e.ctrlKey)&&cn(e),r=e.altKey||e.metaKey||((t=e.getModifierState)===null||t===void 0?void 0:t.call(e,"AltGraph"));return Yr[(n?1:0)+(r?2:0)]}function no(e,t){const n=o=>o.orig===t.orig&&o.dest===t.dest,r=e.shapes.find(n);r&&(e.shapes=e.shapes.filter(o=>!n(o))),(!r||r.brush!==t.brush)&&e.shapes.push({orig:t.orig,dest:t.dest,brush:t.brush}),xn(e)}function xn(e){e.onChange&&e.onChange(e.shapes)}function ro(e,t){if(!t.isTrusted||t.button!==void 0&&t.button!==0||t.touches&&t.touches.length>1)return;const n=e.dom.bounds(),r=de(t),o=he(r,$(e),n);if(!o)return;const i=e.pieces.get(o),l=e.selected;!l&&e.drawable.enabled&&(e.drawable.eraseOnClick||!i||i.color!==e.turnColor)&&eo(e),t.cancelable!==!1&&(!t.touches||e.blockTouchScroll||i||l||oo(e,r))&&t.preventDefault();const s=!!e.premovable.current,c=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&mt(e,e.selected,o)?ie(d=>ot(d,o),e):ot(e,o);const a=e.selected===o,h=Tn(e,o);if(i&&h&&a&&Kr(e,o)){e.draggable.current={orig:o,piece:i,origPos:r,pos:r,started:e.draggable.autoDistance&&e.stats.dragged,element:h,previouslySelected:l,originTarget:t.target,keyHasChanged:!1},h.cgDragging=!0,h.classList.add("dragging");const d=e.dom.elements.ghost;d&&(d.className=`ghost ${i.color} ${i.role}`,B(d,Me(n)(P(o),$(e))),pt(d,!0)),_t(e)}else s&&re(e),c&&oe(e);e.dom.redraw()}function oo(e,t){const n=$(e),r=e.dom.bounds(),o=Math.pow(r.width/8,2);for(const i of e.pieces.keys()){const l=an(i,n,r);if(Ee(l,t)<=o)return!0}return!1}function io(e,t,n,r){const o="a0";e.pieces.set(o,t),e.dom.redraw();const i=de(n);e.draggable.current={orig:o,piece:t,origPos:i,pos:i,started:!0,element:()=>Tn(e,o),originTarget:n.target,newPiece:!0,force:!!r,keyHasChanged:!1},_t(e)}function _t(e){requestAnimationFrame(()=>{var t;const n=e.draggable.current;if(!n)return;!((t=e.animation.current)===null||t===void 0)&&t.plan.anims.has(n.orig)&&(e.animation.current=void 0);const r=e.pieces.get(n.orig);if(!r||!rt(r,n.piece))Fe(e);else if(!n.started&&Ee(n.pos,n.origPos)>=Math.pow(e.draggable.distance,2)&&(n.started=!0),n.started){if(typeof n.element=="function"){const i=n.element();if(!i)return;i.cgDragging=!0,i.classList.add("dragging"),n.element=i}const o=e.dom.bounds();B(n.element,[n.pos[0]-o.left-o.width/16,n.pos[1]-o.top-o.height/16]),n.keyHasChanged||(n.keyHasChanged=n.orig!==he(n.pos,$(e),o))}_t(e)})}function so(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.pos=de(t))}function lo(e,t){const n=e.draggable.current;if(!n)return;if(t.type==="touchend"&&t.cancelable!==!1&&t.preventDefault(),t.type==="touchend"&&n.originTarget!==t.target&&!n.newPiece){e.draggable.current=void 0;return}re(e),oe(e);const r=de(t)||n.pos,o=he(r,$(e),e.dom.bounds());o&&n.started&&n.orig!==o?n.newPiece?vn(e,n.orig,o,n.force):(e.stats.ctrlKey=t.ctrlKey,bn(e,n.orig,o)&&(e.stats.dragged=!0)):n.newPiece?e.pieces.delete(n.orig):e.draggable.deleteOnDropOff&&!o&&(e.pieces.delete(n.orig),O(e.events.change)),(n.orig===n.previouslySelected||n.keyHasChanged)&&(n.orig===o||!o)?D(e):e.selectable.enabled||D(e),Mn(e),e.draggable.current=void 0,e.dom.redraw()}function Fe(e){const t=e.draggable.current;t&&(t.newPiece&&e.pieces.delete(t.orig),e.draggable.current=void 0,D(e),Mn(e),e.dom.redraw())}function Mn(e){const t=e.dom.elements;t.ghost&&pt(t.ghost,!1)}function Tn(e,t){let n=e.dom.elements.board.firstChild;for(;n;){if(n.cgKey===t&&n.tagName==="PIECE")return n;n=n.nextSibling}}function co(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(()=>{It(e,2),setTimeout(()=>It(e,void 0),120)},120)}function It(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}function ao(e,t){function n(){Tr(e),t()}return{set(r){r.orientation&&r.orientation!==e.orientation&&n(),Sn(e,r),(r.fen?ie:J)(o=>Cn(o,r),e)},state:e,getFen:()=>Wr(e.pieces),toggleOrientation:n,setPieces(r){ie(o=>Nr(o,r),e)},selectSquare(r,o){r?ie(i=>ot(i,r,o),e):e.selected&&(D(e),e.dom.redraw())},move(r,o){ie(i=>gn(i,r,o),e)},newPiece(r,o){ie(i=>gt(i,r,o),e)},playPremove(){if(e.premovable.current){if(ie(Fr,e))return!0;e.dom.redraw()}return!1},playPredrop(r){if(e.predroppable.current){const o=jr(e,r);return e.dom.redraw(),o}return!1},cancelPremove(){J(re,e)},cancelPredrop(){J(oe,e)},cancelMove(){J(r=>{vt(r),Fe(r)},e)},stop(){J(r=>{$t(r),Fe(r)},e)},explode(r){co(e,r)},setAutoShapes(r){J(o=>o.drawable.autoShapes=r,e)},setShapes(r){J(o=>o.drawable.shapes=r,e)},getKeyAtDomPos(r){return he(r,$(e),e.dom.bounds())},redrawAll:t,dragNewPiece(r,o,i){io(e,r,o,i)},destroy(){$t(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}function fo(){return{pieces:kn(wn),orientation:"white",turnColor:"white",coordinates:!0,ranksPosition:"right",autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,pieceKey:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},prevSvgHash:""},hold:Ar()}}function it(e,t,n){const r=new Map,o=[];for(const s of e)r.set(s.hash,!1);let i=t.firstChild,l;for(;i;)l=i.getAttribute("cgHash"),r.has(l)?r.set(l,!0):o.push(i),i=i.nextSibling;for(const s of o)t.removeChild(s);for(const s of e)r.get(s.hash)||t.appendChild(n(s))}function K(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function uo(e,t,n){const r=e.drawable,o=r.current,i=o&&o.mouseSq?o:void 0,l=new Map,s=e.dom.bounds(),c=r.autoShapes.filter(u=>!u.piece);for(const u of r.shapes.concat(c).concat(i?[i]:[]))u.dest&&l.set(u.dest,(l.get(u.dest)||0)+1);const a=r.shapes.concat(c).map(u=>({shape:u,current:!1,hash:Dt(u,l,!1,s)}));i&&a.push({shape:i,current:!0,hash:Dt(i,l,!0,s)});const h=a.map(u=>u.hash).join(";");if(h===e.drawable.prevSvgHash)return;e.drawable.prevSvgHash=h;const d=t.querySelector("defs"),f=t.querySelector("g"),g=n.querySelector("g");ho(r,a,d),it(a.filter(u=>!u.shape.customSvg),f,u=>Rt(e,u,r.brushes,l,s)),it(a.filter(u=>u.shape.customSvg),g,u=>Rt(e,u,r.brushes,l,s))}function ho(e,t,n){const r=new Map;let o;for(const s of t)s.shape.dest&&(o=e.brushes[s.shape.brush],s.shape.modifiers&&(o=Nn(o,s.shape.modifiers)),r.set(o.key,o));const i=new Set;let l=n.firstChild;for(;l;)i.add(l.getAttribute("cgKey")),l=l.nextSibling;for(const[s,c]of r.entries())i.has(s)||n.appendChild(_o(c))}function Dt({orig:e,dest:t,brush:n,piece:r,modifiers:o,customSvg:i},l,s,c){return[c.width,c.height,s,e,t,n,t&&(l.get(t)||0)>1,r&&po(r),o&&go(o),i&&mo(i)].filter(a=>a).join(",")}function po(e){return[e.color,e.role,e.scale].filter(t=>t).join(",")}function go(e){return""+(e.lineWidth||"")}function mo(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)>>>0;return"custom-"+t.toString()}function Rt(e,{shape:t,current:n,hash:r},o,i,l){let s;const c=qt(P(t.orig),e.orientation);if(t.customSvg)s=bo(t.customSvg,c,l);else if(t.dest){let a=o[t.brush];t.modifiers&&(a=Nn(a,t.modifiers)),s=yo(a,c,qt(P(t.dest),e.orientation),n,(i.get(t.dest)||0)>1,l)}else s=vo(o[t.brush],c,n,l);return s.setAttribute("cgHash",r),s}function bo(e,t,n){const[r,o]=je(t,n),i=te(K("g"),{transform:`translate(${r},${o})`}),l=te(K("svg"),{width:1,height:1,viewBox:"0 0 100 100"});return i.appendChild(l),l.innerHTML=e,i}function vo(e,t,n,r){const o=je(t,r),i=wo(),l=(r.width+r.height)/(4*Math.max(r.width,r.height));return te(K("circle"),{stroke:e.color,"stroke-width":i[n?0:1],fill:"none",opacity:On(e,n),cx:o[0],cy:o[1],r:l-i[1]/2})}function yo(e,t,n,r,o,i){const l=So(o&&!r),s=je(t,i),c=je(n,i),a=c[0]-s[0],h=c[1]-s[1],d=Math.atan2(h,a),f=Math.cos(d)*l,g=Math.sin(d)*l;return te(K("line"),{stroke:e.color,"stroke-width":ko(e,r),"stroke-linecap":"round","marker-end":"url(#arrowhead-"+e.key+")",opacity:On(e,r),x1:s[0],y1:s[1],x2:c[0]-f,y2:c[1]-g})}function _o(e){const t=te(K("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild(te(K("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function te(e,t){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.setAttribute(n,t[n]);return e}function qt(e,t){return t==="white"?e:[7-e[0],7-e[1]]}function Nn(e,t){return{color:e.color,opacity:Math.round(e.opacity*10)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth),key:[e.key,t.lineWidth].filter(n=>n).join("")}}function wo(){return[3/64,4/64]}function ko(e,t){return(e.lineWidth||10)*(t?.85:1)/64}function On(e,t){return(e.opacity||1)*(t?.9:1)}function So(e){return(e?20:10)/64}function je(e,t){const n=Math.min(1,t.width/t.height),r=Math.min(1,t.height/t.width);return[(e[0]-3.5)*n,(3.5-e[1])*r]}function Co(e,t){e.innerHTML="",e.classList.add("cg-wrap");for(const c of Sr)e.classList.toggle("orientation-"+c,t.orientation===c);e.classList.toggle("manipulable",!t.viewOnly);const n=z("cg-container");e.appendChild(n);const r=z("cg-board");n.appendChild(r);let o,i,l;if(t.drawable.visible&&(o=te(K("svg"),{class:"cg-shapes",viewBox:"-4 -4 8 8",preserveAspectRatio:"xMidYMid slice"}),o.appendChild(K("defs")),o.appendChild(K("g")),i=te(K("svg"),{class:"cg-custom-svgs",viewBox:"-3.5 -3.5 8 8",preserveAspectRatio:"xMidYMid slice"}),i.appendChild(K("g")),l=z("cg-auto-pieces"),n.appendChild(o),n.appendChild(i),n.appendChild(l)),t.coordinates){const c=t.orientation==="black"?" black":"",a=t.ranksPosition==="left"?" left":"";n.appendChild(Kt(ut,"ranks"+c+a)),n.appendChild(Kt(ft,"files"+c))}let s;return t.draggable.enabled&&t.draggable.showGhost&&(s=z("piece","ghost"),pt(s,!1),n.appendChild(s)),{board:r,container:n,wrap:e,ghost:s,svg:o,customSvg:i,autoPieces:l}}function Kt(e,t){const n=z("coords",t);let r;for(const o of e)r=z("coord"),r.textContent=o,n.appendChild(r);return n}function Po(e,t){if(!e.dropmode.active)return;re(e),oe(e);const n=e.dropmode.piece;if(n){e.pieces.set("a0",n);const r=de(t),o=r&&he(r,$(e),e.dom.bounds());o&&vn(e,"a0",o)}e.dom.redraw()}function Ao(e,t){const n=e.dom.elements.board;if("ResizeObserver"in window&&new ResizeObserver(t).observe(e.dom.elements.wrap),(e.disableContextMenu||e.drawable.enabled)&&n.addEventListener("contextmenu",o=>o.preventDefault()),e.viewOnly)return;const r=xo(e);n.addEventListener("touchstart",r,{passive:!1}),n.addEventListener("mousedown",r,{passive:!1})}function Eo(e,t){const n=[];if("ResizeObserver"in window||n.push(we(document.body,"chessground.resize",t)),!e.viewOnly){const r=Ft(e,so,Xr),o=Ft(e,lo,Jr);for(const l of["touchmove","mousemove"])n.push(we(document,l,r));for(const l of["touchend","mouseup"])n.push(we(document,l,o));const i=()=>e.dom.bounds.clear();n.push(we(document,"scroll",i,{capture:!0,passive:!0})),n.push(we(window,"resize",i,{passive:!0}))}return()=>n.forEach(r=>r())}function we(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}const xo=e=>t=>{e.draggable.current?Fe(e):e.drawable.current?En(e):t.shiftKey||cn(t)?e.drawable.enabled&&Zr(e,t):e.viewOnly||(e.dropmode.active?Po(e,t):ro(e,t))},Ft=(e,t,n)=>r=>{e.drawable.current?e.drawable.enabled&&n(e,r):e.viewOnly||t(e,r)};function Mo(e){const t=$(e),n=Me(e.dom.bounds()),r=e.dom.elements.board,o=e.pieces,i=e.animation.current,l=i?i.plan.anims:new Map,s=i?i.plan.fadings:new Map,c=e.draggable.current,a=No(e),h=new Set,d=new Set,f=new Map,g=new Map;let u,p,b,y,w,m,A,S,W,F;for(p=r.firstChild;p;){if(u=p.cgKey,$n(p))if(b=o.get(u),w=l.get(u),m=s.get(u),y=p.cgPiece,p.cgDragging&&(!c||c.orig!==u)&&(p.classList.remove("dragging"),B(p,n(P(u),t)),p.cgDragging=!1),!m&&p.cgFading&&(p.cgFading=!1,p.classList.remove("fading")),b){if(w&&p.cgAnimating&&y===ke(b)){const k=P(u);k[0]+=w[2],k[1]+=w[3],p.classList.add("anim"),B(p,n(k,t))}else p.cgAnimating&&(p.cgAnimating=!1,p.classList.remove("anim"),B(p,n(P(u),t)),e.addPieceZIndex&&(p.style.zIndex=Ve(P(u),t)));y===ke(b)&&(!m||!p.cgFading)?h.add(u):m&&y===ke(m)?(p.classList.add("fading"),p.cgFading=!0):Ye(f,y,p)}else Ye(f,y,p);else if(Ln(p)){const k=p.className;a.get(u)===k?d.add(u):Ye(g,k,p)}p=p.nextSibling}for(const[k,R]of a)if(!d.has(k)){W=g.get(R),F=W&&W.pop();const x=n(P(k),t);if(F)F.cgKey=k,B(F,x);else{const E=z("square",R);E.cgKey=k,B(E,x),r.insertBefore(E,r.firstChild)}}for(const[k,R]of o)if(w=l.get(k),!h.has(k))if(A=f.get(ke(R)),S=A&&A.pop(),S){S.cgKey=k,S.cgFading&&(S.classList.remove("fading"),S.cgFading=!1);const x=P(k);e.addPieceZIndex&&(S.style.zIndex=Ve(x,t)),w&&(S.cgAnimating=!0,S.classList.add("anim"),x[0]+=w[2],x[1]+=w[3]),B(S,n(x,t))}else{const x=ke(R),E=z("piece",x),pe=P(k);E.cgPiece=x,E.cgKey=k,w&&(E.cgAnimating=!0,pe[0]+=w[2],pe[1]+=w[3]),B(E,n(pe,t)),e.addPieceZIndex&&(E.style.zIndex=Ve(pe,t)),r.appendChild(E)}for(const k of f.values())Bt(e,k);for(const k of g.values())Bt(e,k)}function To(e){const t=$(e),n=Me(e.dom.bounds());let r=e.dom.elements.board.firstChild;for(;r;)($n(r)&&!r.cgAnimating||Ln(r))&&B(r,n(P(r.cgKey),t)),r=r.nextSibling}function jt(e){var t,n;const r=e.dom.elements.wrap.getBoundingClientRect(),o=e.dom.elements.container,i=r.height/r.width,l=Math.floor(r.width*window.devicePixelRatio/8)*8/window.devicePixelRatio,s=l*i;o.style.width=l+"px",o.style.height=s+"px",e.dom.bounds.clear(),(t=e.addDimensionsCssVarsTo)===null||t===void 0||t.style.setProperty("--cg-width",l+"px"),(n=e.addDimensionsCssVarsTo)===null||n===void 0||n.style.setProperty("--cg-height",s+"px")}const $n=e=>e.tagName==="PIECE",Ln=e=>e.tagName==="SQUARE";function Bt(e,t){for(const n of t)e.dom.elements.board.removeChild(n)}function Ve(e,t){const r=e[1];return`${t?3+7-r:3+r}`}const ke=e=>`${e.color} ${e.role}`;function No(e){var t;const n=new Map;if(e.lastMove&&e.highlight.lastMove)for(const i of e.lastMove)X(n,i,"last-move");if(e.check&&e.highlight.check&&X(n,e.check,"check"),e.selected&&(X(n,e.selected,"selected"),e.movable.showDests)){const i=(t=e.movable.dests)===null||t===void 0?void 0:t.get(e.selected);if(i)for(const s of i)X(n,s,"move-dest"+(e.pieces.has(s)?" oc":""));const l=e.premovable.dests;if(l)for(const s of l)X(n,s,"premove-dest"+(e.pieces.has(s)?" oc":""))}const r=e.premovable.current;if(r)for(const i of r)X(n,i,"current-premove");else e.predroppable.current&&X(n,e.predroppable.current.key,"current-premove");const o=e.exploding;if(o)for(const i of o.keys)X(n,i,"exploding"+o.stage);return n}function X(e,t,n){const r=e.get(t);r?e.set(t,`${r} ${n}`):e.set(t,n)}function Ye(e,t,n){const r=e.get(t);r?r.push(n):e.set(t,[n])}function Oo(e,t){const r=e.drawable.autoShapes.filter(o=>o.piece).map(o=>({shape:o,hash:Io(o),current:!1}));it(r,t,o=>Lo(e,o,e.dom.bounds()))}function $o(e){var t;const n=$(e),r=Me(e.dom.bounds());let o=(t=e.dom.elements.autoPieces)===null||t===void 0?void 0:t.firstChild;for(;o;)ln(o,r(P(o.cgKey),n),o.cgScale),o=o.nextSibling}function Lo(e,{shape:t,hash:n},r){var o,i,l;const s=t.orig,c=(o=t.piece)===null||o===void 0?void 0:o.role,a=(i=t.piece)===null||i===void 0?void 0:i.color,h=(l=t.piece)===null||l===void 0?void 0:l.scale,d=z("piece",`${c} ${a}`);return d.setAttribute("cgHash",n),d.cgKey=s,d.cgScale=h,ln(d,Me(r)(P(s),$(e)),h),d}const Io=e=>{var t,n,r;return[e.orig,(t=e.piece)===null||t===void 0?void 0:t.role,(n=e.piece)===null||n===void 0?void 0:n.color,(r=e.piece)===null||r===void 0?void 0:r.scale].join(",")};function Do(e,t){const n=fo();Cn(n,t||{});function r(){const o="dom"in n?n.dom.unbind:void 0,i=Co(e,n),l=Pr(()=>i.board.getBoundingClientRect()),s=h=>{Mo(a),i.autoPieces&&Oo(a,i.autoPieces),!h&&i.svg&&uo(a,i.svg,i.customSvg)},c=()=>{jt(a),To(a),i.autoPieces&&$o(a)},a=n;return a.dom={elements:i,bounds:l,redraw:Ro(s),redrawNow:s,unbind:o},a.drawable.prevSvgHash="",jt(a),s(!1),Ao(a,c),o||(a.dom.unbind=Eo(a,c)),a.events.insert&&a.events.insert(i),a}return ao(r(),r)}function Ro(e){let t=!1;return()=>{t||(t=!0,requestAnimationFrame(()=>{e(),t=!1}))}}function qo(){const e={mount:(t,n)=>{e.api=Do(t,n)},cleanup:()=>{var t;(t=e.api)===null||t===void 0||t.destroy()},api:null};return e}var Ko=async e=>{typeof e=="string"?await navigator.clipboard.writeText(e):await navigator.clipboard.write(e)};const Fo=ct("<div></div>",2),jo=ct('<div class="text-right px-2"></div>',2),Bo=ct('<div class="grid grid-cols-[3fr_1fr] gap-4 p-4"><div class="bg-stone-300"><div style="width: 100%; aspect-ratio: 1/1"></div></div><div><div class="w-full grid grid-cols-3 gap-2 p-2"><button class="text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-sky-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700">Prev</button><button class="text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-sky-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700">Next</button><button class="text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-sky-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700">Export PGN</button></div><div class="grid grid-cols-[min-content_1fr_1fr]"><div class="col-span-2 cursor-pointer"><em>starting position</em></div></div></div><div class="grid grid-rows-[min-content_1fr] col-span-2 h-44 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700"><div><button class="text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-2 focus:ring-sky-300 font-medium rounded-lg text-sm px-3 py-1.5 m-2 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700">Load moves</button></div><textarea class="block p-2.5 w-full text-sm text-gray-900 bg-white border-t border-gray-300 dark:border-gray-600 rounded-b-lg focus:outline-none focus:ring-2 focus:ring-sky-300 focus:border-sky-300 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-sky-300 dark:focus:border-sky-300"></textarea></div></div>',30);var ae;(function(e){e.Ok="ok",e.FirstError="first-error",e.Unknown="unknown"})(ae||(ae={}));const Uo=e=>{const t=Gn({selected:!1},e);return(()=>{const n=Fo.cloneNode(!0);return At(n,"click",e.onClick,!0),At(n,"dblclick",e.onDblClick,!0),le(n,()=>e.san,null),le(n,ee(Vn,{fallback:"?",get children(){return[ee(Ct,{get when(){return e.state===ae.Ok},children:"✔️"}),ee(Ct,{get when(){return e.state===ae.FirstError},children:"❌"})]}}),null),Ce(r=>{const o=!!e.onClick,i=!!t.selected;return o!==r._v$&&n.classList.toggle("cursor-pointer",r._v$=o),i!==r._v$2&&n.classList.toggle("bg-slate-100",r._v$2=i),r},{_v$:void 0,_v$2:void 0}),n})()},Ut=e=>(()=>{const t=jo.cloneNode(!0);return le(t,()=>e.num),t})(),Ho=()=>{let[e,t]=sr({moves:[],ply:0,initialFen:new Ot().fen()}),n=f=>{if(f===0)t("ply",0);else{if(e.moves[f-1].fen===null){let g=e.moves.findLastIndex(u=>u.fen!==null);t("ply",g+1);return}if(f<0||f>e.moves.length||e.moves[f-1].fen===null)return;t("ply",f)}},r=`e4 c5
Nf3 d6
d4 cxd4
Nxd4 Nf6
Nc3 a6`,[o,i]=st(r),l={orientation:"white",viewOnly:!0},s=qo(),c=(f,g)=>{let u=g===0?e.initialFen:f[g-1].fen;if(u===null)return{validMoves:0};let p=new Ot(u),b;for(b=g;b<f.length;b++){let y=f[b],w;try{w=p.move(y.san)}catch{break}y.fen=w.after,y.lastMove=[w.from,w.to]}for(let y=b;y<f.length;y++){let w=f[y];w.fen=null,w.lastMove=null}return{validMoves:b}},a=()=>{let f=[];for(let g=0;g<e.moves.length;g++)g%2===0&&f.push(`${Math.floor(g/2+1)}.`),f.push(e.moves[g].san);return f.join(" ")},h=f=>{let g=f.split(/\s+/g).map(p=>({san:p,fen:null,lastMove:null})),{validMoves:u}=c(g,0);Qt(()=>{t("moves",g),t("ply",u)})},d=f=>{n(f)};return Rn(qn([()=>e.ply,()=>e.moves],([f,g])=>{if(f===0)s.api.set({fen:e.initialFen,lastMove:void 0});else{let u=g[f-1];s.api.set({fen:u.fen,lastMove:u.lastMove})}})),(()=>{const f=Bo.cloneNode(!0),g=f.firstChild,u=g.firstChild,p=g.nextSibling,b=p.firstChild,y=b.firstChild,w=y.nextSibling,m=w.nextSibling,A=b.nextSibling,S=A.firstChild,W=p.nextSibling,F=W.firstChild,k=F.firstChild,R=F.nextSibling;return Jn(x=>s.mount(x,l),u),y.$$click=()=>{n(e.ply-1)},w.$$click=()=>{n(e.ply+1)},m.$$click=()=>{Ko(a())},le(A,ee(Ut,{num:null}),S),S.$$click=()=>d(0),le(A,ee(zn,{get each(){return e.moves},children:(x,E)=>{let pe=()=>x().fen!==null?ae.Ok:E===0||e.moves[E-1].fen!==null?ae.FirstError:ae.Unknown;return[E%2===0&&ee(Ut,{get num(){return Math.floor(E/2+1)}}),ee(Uo,{onDblClick:()=>{let wt=prompt(`Change from ${x().san} to: `);wt&&t(lr(He=>{He.moves[E].san=wt,c(He.moves,E),He.ply=E+1}))},get san(){return x().san},get state(){return pe()},onClick:()=>{d(E+1)},get selected(){return E+1===e.ply}})]}}),null),k.$$click=()=>h(o()),R.$$input=x=>i(x.currentTarget.value),le(R,o),Ce(()=>S.classList.toggle("bg-slate-100",e.ply===0)),f})()};Xn(["dblclick","click","input"]);const Wo=document.getElementById("root");Zn(()=>ee(Ho,{}),Wo);
